<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Живые воспоминания</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #faf7f0;
      --card: #ffffff;
      --text: #222222;
      --muted: #6b6f80;
      --accent-start: #667eea;
      --accent-end: #764ba2;
      --shadow: 0 12px 32px rgba(16, 24, 40, 0.08);
      --radius: 16px;
      --radius-sm: 12px;
      --gap: 24px;
      --maxw: 1200px;
      --ratio: 3 / 4;
    }
    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
    }
    header {
      background: linear-gradient(135deg, var(--accent-start), var(--accent-end));
      color: #fff;
      text-align: center;
      padding: 64px 16px;
    }
    header h1 {
      margin: 0 0 12px;
      font-family: 'Playfair Display', serif;
      font-size: clamp(36px, 6vw, 56px);
    }
    header p {
      margin: 0;
      font-size: clamp(16px, 2.4vw, 22px);
    }
    main {
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 36px 16px 56px;
    }
    .item {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      margin-bottom: var(--gap);
      overflow: hidden;
      transition: transform .2s ease, box-shadow .2s ease;
    }
    .item-inner {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--gap);
      padding: var(--gap);
      align-items: center;
    }
    @media (max-width: 820px) {
      .item-inner { grid-template-columns: 1fr; }
    }
    .panel h3 {
      margin: 0;
      font-size: 15px;
      color: var(--accent-start);
      font-weight: 600;
    }
    .media {
      position: relative;
      border-radius: var(--radius-sm);
      overflow: hidden;
      box-shadow: var(--shadow);
      background: #000;
      cursor: zoom-in;
    }
    .media::before { content: ""; display: block; aspect-ratio: var(--ratio); }
    img, video { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: contain; }
    .overlay { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; z-index: 9999; }
    .overlay.visible { display: flex; }
    .overlay-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,.9); }
    .overlay-box { position: relative; width: min(95vw, 1600px); height: min(95vh, 900px); display: grid; grid-template-rows: 1fr auto; gap: 12px; padding: 12px; }
    .overlay-content { width: 100%; height: 100%; position: relative; }
    .overlay-content img, .overlay-content video { width: 100%; height: 100%; object-fit: contain; background: #000; border-radius: var(--radius-sm); box-shadow: var(--shadow); }
    .overlay-close { position: absolute; top: 8px; right: 8px; width: 36px; height: 36px; border-radius: 999px; border: none; background: linear-gradient(135deg, var(--accent-start), var(--accent-end)); color: #fff; font-size: 22px; cursor: pointer; }
    .compare { position: relative; width: 100%; height: 100%; border-radius: var(--radius-sm); overflow: hidden; background: #000; }
    .compare .layer { position: absolute; inset: 0; }
    .compare .layer.top { overflow: hidden; }
    .compare .layer img, .compare .layer video { width: 100%; height: 100%; object-fit: contain; }
    .compare .handle { position: absolute; top: 0; bottom: 0; left: 50%; width: 2px; background: rgba(255,255,255,.9); }
    .compare .knob { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); width: 40px; height: 40px; border-radius: 999px; background: linear-gradient(135deg, var(--accent-start), var(--accent-end)); display: grid; place-items: center; color: #fff; }
    .compare .range { position: absolute; left: 50%; bottom: 14px; transform: translateX(-50%); width: min(560px, 80%); }
    .compare input[type=range] { width: 100%; appearance: none; height: 4px; background: rgba(255,255,255,.6); border-radius: 999px; }
    .compare input[type=range]::-webkit-slider-thumb { appearance: none; width: 20px; height: 20px; border-radius: 50%; background: #fff; cursor: pointer; }
  </style>
</head>
<body>
  <header>
    <h1>Живые воспоминания</h1>
    <p>Как было и как стало</p>
  </header>
  <main>
    <article class="item">
      <div class="item-inner">
        <figure class="panel">
          <h3>До</h3>
          <div class="media"><img src="photos/before1.jpg" alt="Оригинал 1"></div>
        </figure>
        <figure class="panel">
          <h3>После</h3>
          <div class="media"><video poster="photos/before1.jpg" controls><source src="videos/after1.mp4" type="video/mp4"></video></div>
        </figure>
      </div>
    </article>
  </main>
  <div id="overlay" class="overlay" aria-hidden="true">
    <div class="overlay-backdrop" data-close></div>
    <div class="overlay-box">
      <button class="overlay-close" data-close>&times;</button>
      <div class="overlay-content" id="overlayContent"></div>
    </div>
  </div>
  <script>
    const overlay = document.getElementById('overlay');
    const overlayContent = document.getElementById('overlayContent');

    function openOverlayFrom(node){
      overlayContent.innerHTML = '';
      const item = node.closest('.item');
      const beforeMedia = item && item.querySelector('.panel:nth-child(1) .media img, .panel:nth-child(1) .media video');
      const afterMedia  = item && item.querySelector('.panel:nth-child(2) .media video, .panel:nth-child(2) .media img');
      if(beforeMedia && afterMedia){
        const wrap = document.createElement('div');
        wrap.className = 'compare';
        const bottom = document.createElement('div'); bottom.className='layer bottom'; bottom.appendChild(cloneMedia(afterMedia));
        const top = document.createElement('div'); top.className='layer top'; const topMedia = cloneMedia(beforeMedia); top.appendChild(topMedia);
        const handle = document.createElement('div'); handle.className='handle'; const knob=document.createElement('div'); knob.className='knob'; knob.innerHTML='&#8646;';
        const rangeWrap=document.createElement('div'); rangeWrap.className='range'; const range=document.createElement('input'); range.type='range'; range.min='0'; range.max='100'; range.value='50'; rangeWrap.appendChild(range);
        wrap.append(bottom,top,handle,knob,rangeWrap); overlayContent.appendChild(wrap);
        function setPos(p){p=Math.min(100,Math.max(0,p));top.style.clipPath=`inset(0 ${100-p}% 0 0)`;handle.style.left=p+'%';knob.style.left=p+'%';}
        setPos(50); range.addEventListener('input',()=>setPos(parseFloat(range.value)));
        let drag=false; wrap.addEventListener('mousedown',()=>drag=true); window.addEventListener('mouseup',()=>drag=false); window.addEventListener('mousemove',e=>{if(drag){const r=wrap.getBoundingClientRect();const p=((e.clientX-r.left)/r.width)*100;range.value=p;setPos(p);}});
        overlay.classList.add('visible'); overlay.setAttribute('aria-hidden','false'); return;
      }
      const single = cloneMedia(node); overlayContent.appendChild(single); overlay.classList.add('visible'); overlay.setAttribute('aria-hidden','false');
    }
    function cloneMedia(src){const t=src.tagName.toLowerCase();if(t==='img'){const e=document.createElement('img');e.src=src.src;return e;}if(t==='video'){const e=document.createElement('video');e.controls=true;const s=src.querySelector('source');if(s)e.src=s.src;return e;}return document.createElement('div');}
    document.addEventListener('click',e=>{const m=e.target.closest('.media img, .media video');if(m){openOverlayFrom(m);}if(e.target.closest('[data-close]')){overlay.classList.remove('visible');}});
  </script>
</body>
</html>